{% extends 'layout.html' %}

{% block content %}
{
    view: "toolbar",
    css: {"background-color" : "#1CA1C1"},
    elements: [
        {
            view: "button", value: "Consumer", width: 100, css: "webix_primary webix_button",
            click: () => {location.href="/consumer";}
        }
    ]
},
{
    align: "center",
    body: {
        rows: [
            { view: "spacer", height: 30 }, // margin처럼 활용하는 빈 공간
            {
                {% if ConsumerSignin and ResearcherCred %}
                view: "toolbar",
                width: 600,
                elementsConfig: {
                    labelWidth: 100, // 모든 요소의 레이블 길이 100
                },
                rows: [
                    {
                        view: "textarea", label: "Credential",
                        placeholder: "Credential here..."
                    },
                    {
                        align: "center",
                        body: {
                            view: "button", value: "Pull Data", width: 200, css: "webix_primary webix_button",
                            click: () => {
                                webix.ajax().post("http://127.0.0.1:5000/consumer/pull-data")
                                    .then((res) => { location.href="/researcher/consumer"; });
                            }
                        }
                    }
                ]
                {% elif ConsumerSignin == False %}
                view: "form",
                id: "signin_form",
                width: 600,
                elementsConfig: {
                    labelWidth: 80,
                },
                elements: [
                    {
                        view: "text", label: "Email", name: "email", placeholder: "name@domain.com",
                        invalidMessage: "Invalid Email address form"
                    },
                    {
                        view: "text", type: "password", label: "Password", name: "password",
                        invalidMessage: "Password can not be empty"
                    },
                    {
                        view: "button", id: "btnSubmit", value: "Submit", hotkey: "enter", css: "webix_primary webix_button",
                        click: () => {
                            var signin_form = $$("btnSubmit").getParentView();
                            if (signin_form.validate()) {
                                var values = signin_form.getValues();
                                values = webix.ajax().stringify(values);

                                webix.ajax().post("http://127.0.0.1:5000/consumer/processSignin", values)
                                    .then((res) => { location.href="/researcher/consumer"; });
                            }
                        }
                    }

                ],
                rules: {
                    "email": webix.rules.isEmail,
                    "password": webix.rules.isNotEmpty
                }
                {% endif %}
            },
        ]
    }
}
{% endblock %}