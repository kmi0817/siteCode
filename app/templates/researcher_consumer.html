{% extends 'researcher.html' %}

{% block researcher %}
{ view: "spacer", height: 30 }, // margin처럼 활용하는 빈 공간
{
{% if ConsumerSignin and PullData %}
    view: "tabview",
    cells: [
        {
            header: "<span style='color: #78B395'>download</span>",
            body: {
                view: "form", id: "download_form", width: 600,
                elements: [
                    { view: "text", label: "file name", placeholder: "파일이 도착하면 자동으로 파일 이름이 입력됨" },
                    {
                        view: "button", value: "download", css: "myButton_research webix_button",
                        click: () => {
                            webix.message("downloading from SFTP Server");
                        }
                    },
                ]
            }
        },
        {
            header: "<span style='color: #78B395'>upload</span>",
            body: {
                view: "form", id: "upload_form", width: 600,
                elements: [
                    { view: "text", label: "file name" },
                    {
                        view: "button", value: "upload", css: "myButton_research webix_button",
                        click: () => {
                            webix.message("uploading to SFTP Server");
                        }
                    },
                ]
            }
        }
    ]
{% elif ConsumerSignin %}
    align: "center",
    body: {
        view: "button", value: "Present Credential", width: 200, css: "myButton_research webix_button",
        click: () => {
            var values = JSON.stringify({"credential" : "researchers_cred_to_consumer"});

            webix.ajax().post("http://127.0.0.1:5000/consumer/receive-cred", values)
                .then((res) => { location.href="/consumer"; });
        }
    }
{% else %}
    align: "center",
    body: {
        view: "button", value: "Accept Invitation", width: 200, css: "myButton_research webix_button",
        click: () => {
            {% if ConsumerSignin %} // consumer 로그인 돼 있다면, 초대장 수락
            var values = JSON.stringify({"invitation" : "temp_consumer"}); // 이거 없으면 Request 오류 발생

            webix.ajax().post("http://127.0.0.1:5000/researcher/accept-con-inv", values)
                .then((res) => { location.reload(); });

            {% else %} // 만약 consumer 로그인 안 돼 있다면, 경고 메시지 출력
            webix.message({type: "error", text: "Consumer Sign in First!"});
            {% endif %}
        }
    }
{% endif %}
}
{% endblock %}
